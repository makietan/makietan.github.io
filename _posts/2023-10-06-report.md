---
layout: post
title:  "ドラクエウォークの地図をエクセルで管理する"
categories: [game, dqw, tech]
date: "2023-10-06 00:00:00"
---

## はじめに

たくさんの地図を獲得できる環境にいるので取捨選択が非常に大変である。
初期地図であれば簡単に捨てられるが、それ以外が悩ましい。
そこでGoogleスプレッドシートを使って整理することにした。

## やったこと

やることは簡単で持っている地図の情報をスプレッドシートに書き込む。
上限50枚（生成で+1の51枚）の枠を作る。
各出現モンスターは12体、SUBが3体、BOSSが1体。
それをただ埋めていくだけ。

埋めた後に以下のような関数を利用して調査した。

### 4つ以上所持しているこころのチェック

4つ以上所持しているこころの一覧を別のシートで作る。
それに VLOOKUP をかけてチェックしたデータをAQ2:BB2に配置して非表示にする。
その個数をもとにその地図の必要性をチェックする。
12であればコンプで、0であれば全てが未コンプ。

```
=ISNA(VLOOKUP(N2,'シート2'!$A$2:$A$207,1,FALSE))

=COUNTIF(AQ2:BB2,FALSE)
```

### 他の地図と同じモンスターが出現しているか

他の地図に対象のモンスターが出現しているかをCOUNTIFで調査する。
この結果をAD2:AO2に配置して非表示にする。
重複しているものが存在するかをCOUNTIFでチェックしてその個数を希少性として判断する。
12であれば大変希少で、0であれば他の地図で代用可能である。

```
=COUNTIF($N$2:$AC,N2)

=COUNTIF(AD2:AO2,"<2")
```

## おわりに

どれも1つは他にないモンスターがいて捨てられない。
いい感じに捨てられる地図が全然ない...。
低ランクの地図をコンプ復活を繰り返して先に4つ揃えることを頑張るのがよさそうかな。
100枚くらい保持したいよー。
