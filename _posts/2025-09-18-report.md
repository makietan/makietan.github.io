---
layout: post
title:  "NPB.jpの球団別個人成績でOPSを表示するためのブックマークレットを作った"
categories: [tech, baseball]
date: "2025-09-18 00:00:00"
---

<https://npb.jp/bis/2025/stats/>

NPBの公式サイトで個人成績を見ているとOPSが表示されていない。
なので、OPSを表示するためのブックマークレットを作った。

```javascript
javascript:(function(){const t="出塁率",e="長打率",s="OPS";document.querySelectorAll("table").forEach(r=>{let n=-1,o=-1,l=null,c=!1;const a=r.querySelectorAll("th");if(0===a.length)return;a.forEach((s,a)=>{const i=s.textContent.trim();i.includes(t)&&(n=a,l=s.closest("tr")),i.includes(e)&&(o=a),i===s&&c==!0}),l&&-1!==n&&-1!==o&&!c&&(l.insertAdjacentHTML("beforeend",`<th>${s}</th>`),(()=>{const t=Array.from(r.querySelectorAll("tr")),s=t.indexOf(l);t.slice(s+1).filter(t=>!t.querySelector("th")).forEach(t=>{const s=t.cells[n],l=t.cells[o];if(!s||!l)return void t.insertAdjacentHTML("beforeend","<td>-</td>");const c=parseFloat(s.textContent),a=parseFloat(l.textContent);let i;i=isNaN(c)||isNaN(a)?"-":(.001*(1e3*c+1e3*a)).toFixed(3).replace(/^0/,""),t.insertAdjacentHTML("beforeend",`<td>${i}</td>`)})})())})})();
```

これをブックマークに登録して、NPBの個人成績のページでクリックするとOPSが表示される。

以下をドラッグしてブックマークバーに登録してください。

<a href="javascript:(function(){const t=%22%E5%87%BA%E5%A1%8D%E7%8E%87%22,e=%22%E9%95%B7%E6%89%93%E7%8E%87%22,s=%22OPS%22;document.querySelectorAll(%22table%22).forEach(r=>{let n=-1,o=-1,l=null,c=!1;const a=r.querySelectorAll(%22th%22);if(0===a.length)return;a.forEach((s,a)=>{const i=s.textContent.trim();i.includes(t)&&(n=a,l=s.closest(%22tr%22)),i.includes(e)&&(o=a),i===s&&c==!0}),l&&-1!==n&&-1!==o&&!c&&(l.insertAdjacentHTML(%22beforeend%22,`<th>${s}</th>`),(()=>{const t=Array.from(r.querySelectorAll(%22tr%22)),s=t.indexOf(l);t.slice(s+1).filter(t=>!t.querySelector(%22th%22)).forEach(t=>{const s=t.cells[n],l=t.cells[o];if(!s||!l)return void t.insertAdjacentHTML(%22beforeend%22,%22<td>-</td>%22);const c=parseFloat(s.textContent),a=parseFloat(l.textContent);let i;i=isNaN(c)||isNaN(a)?%22-%22:(.001*(1e3*c+1e3*a)).toFixed(3).replace(/^0/,%22%22),t.insertAdjacentHTML(%22beforeend%22,`<td>${i}</td>`)}))())})})})();" target="_blank">NPBのOPSを表示するブックマークレット</a>

